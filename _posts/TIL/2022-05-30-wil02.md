---
layout: single
title:  "서버리스(Serverless)"
permalink: /category/wil2
categories: TIL
published: true
---
**DOM에 대해서는 따로 포스팅을 해뒀으니 여기선 다루지 않겠습니다!**

# 서버리스(Serverless)

직역하자면 '서버가 없다'는 의미이다.
서버리스에서 서버가 없다는건, 단지 표현일뿐 진짜 작업을 처리하는 서버가 존재한다. 하지만 서버가 어떤사양으로 돌아가고, 서버의 갯수를 늘리고, 네트워크를 어떤걸 사용할지에 대해서는 설정할 필요가 없다.  

서버리스는 BaaS와 FaaS 두 가지로 나뉜다.

## BaaS(Backend as a Service)

계산기나 그림판 수준으로 프론트엔드쪽 코드를 구상한다면, 우리는 백엔드 서버를 만들 필요가 없다.  
하지만, 데이터를 저장하고 다른기기에 접근하고 공유하기위해서는 백엔드 개발은 필수적이다.  

서버개발을 하다보면, 서버의 확장이나 보안성에대해 고려해야랑 때가 많다. 그래서 탄생한 서비스가 Firebase 같은 BaaS 이다.  
> 현존하는 BaaS 중 가장 대중화 되어있는것은 Firebase 이다 

이 시스템에서는 개발에 있어서 다양한 기능들 (데이터베이스, 소셜서비스 연동, 파일시스템 등)을 API로 제공해주면서 개발자들이 서버개발을 하지 않고서도 필요한 기능을 쉽고 빠르게 구현할수 있게 되었다.  
서버의 이용자가 순식간에 늘어나도, 따로 대비하지 않아도 알아서 확장이된다.

### BaaS의 장단점
(firebase를 사용한다는 가정하에 작성되었다.)

장점
- 
- 개발시간의 단축  
회사 입장에서 생각한다면 인건비를 절약할수 있다.
- 서버확장 작업의 불필요함
- 백엔드의 지식이 크지않아도 개발이 가능하다

특히 Firebase 에서는 실시간 데이터베이스를 사용하여  데이터가 새로 생성되거나, 수정되었을 때 소켓을 사용하여 클라이언트에게 바로 반영시켜주는 기능이 있다.  
이러한 기능은 직접 개발하게 된다면 구조 설정에 꽤 많은 시간이 필요 할 수도 있는데 이를 단지 코드 몇줄만으로 구현 할 수 있게 해준다.

단점
-
1. 클라이언트 위주의 코드

BaaS 를 사용함으로서, 백엔드 로직들이 클라이언트쪽에 구현이 된다.
(이메일발송, 결제처리 등의 작업들)  
Firebase 의 경우에는  Firebase SDK 를 불러와서 사용하면 서버쪽에서도 사용이 가능하긴 하지만 일부 로직을 직접 서버측에서 구현할 바에, 그냥 모든 로직을 직접 구현하는것이 더 낫다.

또한 데이터단의 로직이 변경되면 클라이언트 코드의 수정이 이뤄지게 된다. 그렇게 되면 재배포를 해야한다.  
웹어플리케이션이라면 JS 를 새로 받아야하고 모바일 앱이라면, 앱 업데이트를 해야한다. 그리고 상황에 따라서 구버전 사용자를 강제 업데이트해야 하는일이 발생 할 수도 있다.

2. 가격
Firebase 의 경우엔 초반엔 무료지만  앱의 규모가 커지면 가격이 비싸진다. 실시간 데이터베이스에 10G 가 쌓이고, 한달 전송되는 데이터의 양이 20G 정도면 데이터베이스 비용으로만 $70 가 발생한다.  
따라서 사용자가 별로 없을 것 같은 서비스면 Firebase 는 정말 좋은 선택이지만 서비스의 규모가 커질수록 직접 구현을 했을 때 대비 지출되는 비용이 늘어날 것이다.


## FaaS (Function as a Service)

FaaS 는 프로젝트를 여러개의 함수로 쪼개서 (혹은 한개의 함수로 만들어서), 매우 거대하고 분산된 컴퓨팅 자원에 준비해둔 함수를 등록하고, 이 함수들이 실행되는 횟수 (그리고 실행된 시간) 만큼 비용을 내는 방식이다. 

PaaS 와의 주요 차이점

서버 시스템에 대해서 신경쓰지 않아도 된다는 점이 PaaS 와 유사하지만  
가장 중요한 차이점은 PaaS 의 경우, 전체 애플리케이션을 배포하고 어떤 서버에서 배포한 애플리케이션이 24시간동안 계속 돌아가고 있다는 점 이다.

반면 FaaS 는 애플리케이션이 아닌 함수를 배포하고 계속 실행되고 있는 것이 아닌 특정 이벤트가 발생 했을 때 실행되며, 실행이 되었다가 작업을 마치면 (혹은 최대 타임아웃 시간을 지나면) 종료된다.

### FaaS의 장단점

장점
-
1. 비용  
특정 작업을 하기 위하여 서버를 준비하고 하루종일 켜놓는것이 아니라 필요할때만 함수가 호출되어 처리되며 함수가 호출된 만큼만 비용이 드는것이라서 비용이 많이 절약된다.

2. 인프라 관리  
네트워크, 장비 이런것들에 대한 구성 작업을 신경 쓸 필요 없다.  
3. 인프라 보안  
 리눅스 업데이트, 최근 발생한 Intel Meltdown 취약점 보안패치, 이런것들 또한 신경 쓸 필요 없다.  
4. 확장성  
FaaS 는 확장성 면에서 매우 뛰어나다. 일반적으로 FaaS 를 사용하지 않는다면 다양한 트래픽에 유연한 대응을 하기 위하여 우리는 AWS 의 Auto Scaling 같은 기술을 사용한다. 이를 통해 CPU 사용량, 네트워크 처리량에 따라 서버의 갯수를 늘리는 방식으로 처리를 분산시킨다.  
FaaS 를 사용하게 되면 이렇게 특정 조건에 따라 자동으로 확장되는 것이 아니라 그냥 확장이 된다. 함수가 1초에 1개가 호출되면 1개가 호출되는것이고 100개가 호출되면 100 개가 호출되는것 이다.

단점
-
1. 제한  
모든 코드를 함수로 쪼개서 작업하면 함수에서 사용 할 수 있는 자원에 제한이 있다. 하나의 함수가 한번 호출 될 때 AWS 에서는 최대 1500MB 의 메모리까지 사용 가능하며, 처리시간은 최대 300 초 까지 사용 가능하다.  
때문에 웹소켓 같이 계속 켜놔야 하는것은 사용하지 못한다. 대신에, AWS IoT, Pusher 등의 서비스를 사용하면 된다.  
2. FaaS 제공사에 강한 의존  
AWS, Azure, Google 등의 FaaS 제공사에 강한 의존을 하게 된다. 
가능성은 적지만 제공사가 잘못된다면 타격이 클 것이다.

3. 로컬 데이터 사용 불가능  
함수들은 무상태적(stateless)이다. 때문에 데이터를 로컬 스토리지에서 읽고 쓸 수 없다.  대신에, AWS 라면 S3, Azure 라면 Storage 를 이용 할 수 있다.


